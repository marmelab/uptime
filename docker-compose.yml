watcher:
    image: golang
    environment:
        GOPATH: /usr/src/watcher
        CONFIG_PATH: /usr/src/watcher/src/marmelab.com/uptime/conf.json
    volumes:
        - .:/usr/src/watcher
    working_dir: /usr/src/watcher/src/marmelab.com/uptime
    command: go run main.go
    links:
        - "api"
        - "website"
    restart: always
api:
    image: golang
    environment:
        GOPATH: /usr/src/api
    volumes:
        - .:/usr/src/api
    working_dir: /usr/src/api/src/marmelab.com/uptime/api
    command: go run main.go
    ports:
        - "8383:8383"
    links:
        - "db"
    restart: always

website:
    image: nginx
    ports:
        - "8282:82"
    volumes:
        - ./nginxContainer/static-html-directory:/usr/share/nginx/html

db:
    image: postgres
    volumes:
        - .:/usr/src/db
    restart: always

webpack:
    image: iojs:1.6.3
    working_dir: /usr/src/webpack/front
    volumes:
        - .:/usr/src/webpack
    working_dir: /usr/src/webpack/front
    command: ./node_modules/.bin/webpack-dev-server --progress --hot --host=0.0.0.0
    ports:
        - "8080:8080"

client:
    image: iojs:1.6.3
    ports:
        - "8000:8000"
    volumes:
        - ./front:/usr/src/client
    working_dir: /usr/src/client
    command: node /usr/src/client/server.js
    links:
        - "api"
    restart: always
